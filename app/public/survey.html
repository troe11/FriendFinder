<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <title>Friend Finder Survey - Movie Edition</title>
</head>

<body>
    <div class=“jumbotron” style="padding-top: 5%; padding-left:25%">
        <h1>Welcome to the Friend Finder Survey!</h1>
        <p>Consider each question carefully. Choose 1 if you completely disagree and 5 for totally agree....Good Luck!</p>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>1. I watch all Oscar noms no matter how pretentious</h4>
        <select class="custom-select" id='q1'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>2. I like indie films more than big budget action films</h4>
        <select class="custom-select" id='q2'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>3. Star Wars is better than Star Trek</h4>
        <select class="custom-select" id='q3'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>4. Harry Potter books are better than Harry Potter movies</h4>
        <select class="custom-select" id='q4'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>5. DC movies are better than Marvel movies</h4>
        <select class="custom-select" id='q5'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>6. Indiana Jones 4 doesn't exist</h4>
        <select class="custom-select" id='q6'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>7. The Jurassic Park movies get worse</h4>
        <select class="custom-select" id='q7'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>8. The Dark Knight is the best superhero movie ever</h4>
        <select class="custom-select" id='q8'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>9. Back to the Future is the best trilogy of all time</h4>
        <select class="custom-select" id='q9'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class='questionDiv' style="padding-left: 5%">
        <h4>10. The Star Wars sequels are better than the prequels</h4>
        <select class="custom-select" id='q10'>
            <option selected>Choose a number</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
    <br>
    <br>
    <div class="panel-body">
        <h3 style="padding-left: 5%">What is your name?</h3>
        <input type="text" id="addName" style="margin: 0 5%">
        <br>
        <div class="text-center">
            <button type="submit" class="btn btn-primary btn-md" id="submit-btn"><span class="glyphicon glyphicon-search"></span> Click here when you're done!</button>
        </div>
    </div>
    <div class="modal fade" id='myModal'>
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">New Friend Found!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id='close'>Thank You!</button>
                    
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $('#close').on('click',function(){
            $('#myModal').modal('hide');
        })
    $('#submit-btn').on('click', function() {
        var points = [];
        for (let i = 1; i < 11; i++) {
            var num = $('#q' + i).val();
            points.push(num);
        };
        var name = $('#addName').val();
        $.post('/api/friends', {
            'newFriend': [{
                'name': name,
                'scores': points
            }]
        })

        $.get('/api/friends', function(data) {
            var diffObj = {}
            for (var i in data) {
                if (data[i][0]['scores'] !== undefined) {
                    var total = 0;
                    for (let j = 0; j < points.length; j++) {

                        total += Math.abs(points[j] - data[i][0]['scores'][j]);
                    }
                    diffObj[i] = {
                        'name': data[i][0]['name'],
                        'total': diffObj['total' + i] = total
                    };

                }
                var check = 50;
                var name = ''
                for(var x in diffObj){
                    if(diffObj[x]['total'] < check){
                        check = diffObj[x]['total'];
                        name = diffObj[x]['name'];
                    };
                    
                };
                $('.modal-body').text(name + ' is your closest match! We think you two will be very happy together ;)');
                $('#myModal').modal('show');
            }
        })
    })
    </script>
</body>

</html>